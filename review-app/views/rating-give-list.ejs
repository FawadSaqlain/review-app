<h1>Give Reviews</h1>
<div>
  <% if (activeTerm) { %>
    <label>Term: <strong><%= activeTerm.name %> (active)</strong></label>
  <% } else { %>
    <label>Term: <strong>Not available</strong></label>
  <% } %>
</div>

<ul>
  <% 
    const activeTermId = activeTerm ? String(activeTerm._id) : null;
    offerings.forEach(function(o){ 
      // resolve offering.term whether populated (object) or just an id
      let offeringTermId = null;
      if (o && o.term) offeringTermId = String(o.term._id ? o.term._id : o.term);
      if (!activeTermId || !offeringTermId || offeringTermId !== activeTermId) return;
  %>
    <li>
      <strong><%= o.course && o.course.title ? o.course.title : 'Course' %></strong>
      by <%= o.teacher && o.teacher.name ? (o.teacher.name.first || o.teacher.name.last) : 'Teacher' %>
      <% if (o.section) { %> (Section <%= o.section %>) <% } %>
      - <a href="/ratings/form?offering=<%= o._id %>">Give Review</a>
    </li>
  <% }) %>
</ul>

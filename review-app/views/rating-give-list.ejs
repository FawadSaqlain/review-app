<h1>Give Reviews</h1>
<div>
  <label for="termSelect">Term: </label>
  <select id="termSelect">
    <option value="">-- Active term --</option>
    <% if (activeTerm) { %>
      <option value="<%= activeTerm._id %>" <%= selectedTerm && (String(selectedTerm) === String(activeTerm._id)) ? 'selected' : '' %>><%= activeTerm.name %> (active)</option>
    <% } %>
    <% if (nextTerm) { %>
      <option value="<%= nextTerm._id %>" <%= selectedTerm && (String(selectedTerm) === String(nextTerm._id)) ? 'selected' : '' %>><%= nextTerm.name %> (next)</option>
    <% } %>
  </select>
</div>

<ul>
  <% offerings.forEach(function(o){ %>
    <li>
      <strong><%= o.course && o.course.title ? o.course.title : 'Course' %></strong>
      by <%= o.teacher && o.teacher.name ? (o.teacher.name.first || o.teacher.name.last) : 'Teacher' %>
      <% if (o.section) { %> (Section <%= o.section %>) <% } %>
      - <a href="/ratings/form?offering=<%= o._id %>">Give Review</a>
    </li>
  <% }) %>
</ul>

<script>
  document.getElementById('termSelect')?.addEventListener('change', function () {
    const val = this.value;
    const url = new URL(window.location.href);
    if (val) url.searchParams.set('term', val); else url.searchParams.delete('term');
    window.location.href = url.toString();
  });
</script>

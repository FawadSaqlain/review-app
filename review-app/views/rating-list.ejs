<div class="card">
<h1>Ratings</h1>
<style>
  .rating-stars { font-size: 18px; }
  .rating-stars .filled { color: #fbbf24; }
  .rating-stars .empty { color: #e5e7eb; }
</style>
<ul style="list-style:none;padding-left:0;margin-top:12px">
  <% if (typeof summary !== 'undefined' && summary && summary.summary) { %>
    <li style="padding:10px 12px;border-radius:8px;border:1px solid #e5e7eb;margin-bottom:8px;">
      <strong>Summary (stored):</strong>
      <p><%= summary.summary %></p>
      <p><strong>Count:</strong> <%= summary.count %> &nbsp; <strong>Avg overall:</strong> <%= summary.avgOverall ? summary.avgOverall.toFixed(2) : 'N/A' %> &nbsp; <strong>Avg marks:</strong> <%= summary.avgMarks ? summary.avgMarks.toFixed(2) : 'N/A' %></p>
      <em>Generated: <%= new Date(summary.updatedAt || summary.createdAt).toLocaleString() %></em>
    </li>
  <% } else { %>
    <% ratings.forEach(function(r){ %>
      <li style="padding:10px 12px;border-radius:8px;border:1px solid #e5e7eb;margin-bottom:8px;">
        <!-- Student identity hidden: ratings are anonymous -->
        <strong>Overall:</strong>
        <% if (r.overallRating) { %>
          <span class="rating-stars">
            <% for (var i=1;i<=5;i++) { %>
              <span class="<%= i<=r.overallRating ? 'filled' : 'empty' %>">★</span>
            <% } %>
          </span>
          (<%= r.overallRating %>)
        <% } else { %>
          N/A
        <% } %>
        <br />
        <% if (typeof r.obtainedMarks !== 'undefined' && r.obtainedMarks !== null) { %>
          <strong>Obtained Marks:</strong> <%= r.obtainedMarks %>
          <br />
        <% } %>
        <strong>Comment:</strong> <%= r.comment || '—' %>
        <br />
        <em>Submitted: <%= new Date(r.createdAt).toLocaleString() %></em>
      </li>
    <% }) %>
  <% } %>
</ul>
</div>

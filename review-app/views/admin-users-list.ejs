<h1>Manage Users</h1>
<p><a href="/admin/users/new">Create new user</a></p>
<form method="GET" action="/admin/users">
  <input name="q" placeholder="Search by email or name" value="<%= q %>" />
  <button type="submit">Search</button>
</form>
<table>
  <thead><tr><th>Email</th><th>Name</th><th>Role</th><th>Active</th><th>Actions</th></tr></thead>
  <tbody>
    <% users.forEach(function(u){ %>
      <tr>
        <td><%= u.email %></td>
        <td><%= (u.name && (u.name.first || u.name.last)) ? ( (u.name.first||'') + ' ' + (u.name.last||'') ) : '' %></td>
        <td><%= u.role %></td>
        <td><%= u.isActive ? 'Yes' : 'No' %></td>
        <td>
          <a href="/admin/users/<%= u._id %>/edit">Edit</a>
          <form style="display:inline" method="post" action="/admin/users/<%= u._id %>/delete" onsubmit="return confirm('Delete user?');">
            <button type="submit">Delete</button>
          </form>
        </td>
      </tr>
    <% }) %>
  </tbody>
</table>
